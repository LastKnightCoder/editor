import{j as o,S as U,c as _,d as F,e as K,f as W,g as Y,h as z,U as $,_ as O,R as j,E as Z,T as d,i as P,A as ee,M as te,k as B}from"./index-f6fc57fd.js";import{r as p}from"./react-51129ece.js";import"./react-dom-d9a25264.js";import"./mermaid-d49aec67.js";import"./katex-3eb4982e.js";const ae="_selectLanguage_ig76o_1",le={selectLanguage:ae},oe=[{label:"JavaScript",value:"JavaScript"},{label:"js",value:"js"},{label:"TypeScript",value:"TypeScript"},{label:"ts",value:"ts"},{label:"JSX",value:"JSX"},{label:"TSX",value:"TSX"},{label:"HTML",value:"HTML"},{label:"CSS",value:"CSS"},{label:"Vue",value:"Vue"},{label:"C",value:"C"},{label:"C++",value:"C++"},{label:"C#",value:"C#"},{label:"Java",value:"Java"},{label:"Rust",value:"Rust"},{label:"rs",value:"rs"},{label:"Go",value:"Go"},{label:"Python",value:"Python"},{label:"py",value:"py"},{label:"Objective C",value:"Objective C"},{label:"Scale",value:"Scale"},{label:"JSON",value:"JSON"},{label:"XML",value:"HTML/XML"},{label:"YAML",value:"YAML"},{label:"HTTP",value:"HTTP"},{label:"Diff",value:"Diff"},{label:"Bash",value:"Bash"},{label:"Shell",value:"Shell"},{label:"MySQL",value:"MySQL"},{label:"SQL",value:"sql"},{label:"Latex",value:"stex"},{label:"Markdown",value:"markdown"},{label:"md",value:"md"}],ie=v=>{const{value:m,onChange:x,className:i,style:h={}}=v;return o.jsx(U,{showSearch:!0,value:m,onChange:x,placeholder:"选择语言",optionFilterProp:"children",options:oe,filterOption:(c,s)=>{var u;return((u=s==null?void 0:s.label)!=null?u:"").toLowerCase().includes(c.toLowerCase())},className:_(i,le.selectLanguage),style:h})},re=[{name:"Auto",mode:"auto"},{name:"Apache",mode:"apache",mime:"text/apache",custom:!0,highlight:!0},{name:"Bash",mode:"shell",mime:"application/x-sh",highlight:!0},{name:"Plain Text",mode:"text"},{name:"C",mode:"clike",mime:"text/x-csrc",short:"c"},{name:"C++",mode:"clike",mime:"text/x-c++src",short:"c-like",highlight:!0},{name:"C#",mode:"clike",mime:"text/x-csharp",short:"csharp",highlight:!0},{name:"Clojure",mode:"clojure",highlight:!0},{name:"COBOL",mode:"cobol"},{name:"CoffeeScript",mode:"coffeescript",highlight:!0},{name:"Crystal",mode:"crystal",highlight:!0},{name:"CSS",mode:"css",highlight:!0},{name:"D",mode:"d",highlight:!0},{name:"Dart",mode:"dart",highlight:!0},{name:"Diff",mode:"diff",mime:"text/x-diff",highlight:!0},{name:"Django",mode:"django",highlight:!0},{name:"Docker",mode:"dockerfile",highlight:!0},{name:"Elixir",mode:"elixir",custom:!0,highlight:!0},{name:"Elm",mode:"elm",highlight:!0},{name:"Erlang",mode:"erlang",highlight:!0},{name:"F#",mime:"text/x-fsharp",mode:"mllike",short:"fsharp",highlight:!0},{name:"Fortran",mode:"fortran",highlight:!0},{name:"Gherkin",mode:"gherkin",highlight:!0},{name:"GraphQL",mode:"graphql",custom:!0},{name:"Go",mode:"go",mime:"text/x-go",highlight:!0},{name:"Groovy",mode:"groovy",highlight:!0},{name:"Handlebars",mode:"handlebars",highlight:!0},{name:"Haskell",mode:"haskell",highlight:!0},{name:"HTML/XML",mode:"htmlmixed"},{name:"HTML",mode:"htmlmixed"},{name:"HTTP",mime:"message/http",mode:"http"},{name:"Java",mode:"clike",mime:"text/x-java",short:"java",highlight:!0},{name:"JavaScript",mode:"javascript",short:"javascript",highlight:!0},{name:"JSON",mode:"javascript",mime:"application/json",short:"json",highlight:!0},{name:"JSX",mode:"jsx",short:"jsx"},{name:"Julia",mode:"julia",highlight:!0},{name:"Kotlin",mode:"clike",mime:"text/x-kotlin",short:"kotlin",highlight:!0},{name:"LaTeX",mode:"stex",short:"latex",highlight:!0},{name:"Lisp",mode:"commonlisp",short:"lisp",highlight:!0},{name:"Lua",mode:"lua",highlight:!0},{name:"Markdown",mode:"markdown",highlight:!0},{name:"Mathematica",mode:"mathematica",highlight:!0},{name:"MATLAB/Octave",mode:"octave",mime:"text/x-octave",short:"matlab",highlight:!0},{name:"MySQL",mode:"sql",mime:"text/x-mysql",short:"mysql"},{name:"N-Triples",mode:"ntriples",mime:"application/n-triples"},{name:"NGINX",mode:"nginx",highlight:!0},{name:"Nim",mode:"nim",custom:!0,highlight:!0},{name:"Nix",mode:"nix",highlight:!0},{name:"Objective C",mode:"clike",mime:"text/x-objectivec",short:"objectivec",highlight:!0},{name:"OCaml",mode:"mllike",short:"ocaml",highlight:!0},{name:"Pascal",mode:"pascal"},{name:"Perl",mode:"perl",highlight:!0},{name:"PHP",mode:"php",mime:"text/x-php",short:"php",highlight:!0},{name:"PowerShell",mode:"powershell",highlight:!0},{name:"Protocol Buffer",mode:"protobuf"},{name:"Python",mode:"python",highlight:!0},{name:"R",mode:"r",highlight:!0},{name:"RISC-V",mode:"riscv",custom:!0},{name:"Ruby",mode:"ruby",highlight:!0},{name:"Rust",mode:"rust",highlight:!0},{name:"Sass",mode:"sass"},{name:"Scala",mode:"clike",mime:"text/x-scala",short:"scala",highlight:!0},{name:"Smalltalk",mode:"smalltalk",highlight:!0},{name:"Solidity",mode:"solidity",custom:!0},{name:"SPARQL",mode:"sparql",mime:"application/sparql-query"},{name:"SQL",mode:"sql",highlight:!0},{name:"Stan",mode:"stan",highlight:!0},{name:"Stylus",mode:"stylus",mime:"stylus",highlight:!0},{name:"Swift",mode:"swift",highlight:!0},{name:"TCL",mode:"tcl",highlight:!0},{name:"TOML",mode:"toml"},{name:"Turtle",mode:"turtle",mime:"text/turtle"},{name:"TypeScript",mode:"javascript",mime:"application/typescript",short:"typescript",highlight:!0},{name:"TSX",mode:"jsx",mime:"text/typescript-jsx",short:"tsx"},{name:"Twig",mode:"twig",mime:"text/x-twig",highlight:!0},{name:"VB.NET",mode:"vb"},{name:"Verilog",mode:"verilog",highlight:!0},{name:"VHDL",mode:"vhdl",highlight:!0},{name:"Vue",mode:"vue"},{name:"XQuery",mode:"xquery",highlight:!0},{name:"YAML",mode:"yaml",highlight:!0}],ne="_codeBlockContainer_1cujv_1",se="_dark_1cujv_5",me="_readOnly_1cujv_8",he="_languageSelect_1cujv_11",ce="_copyButton_1cujv_14",ue="_windowsControl_1cujv_23",ge="_CodeMirrorContainer_1cujv_48",de="_dragHandler_1cujv_71",pe="_icon_1cujv_84",ve="_canDrag_1cujv_87",xe="_dragging_1cujv_90",fe="_drop_1cujv_93",be="_before_1cujv_96",ye="_after_1cujv_105",t={codeBlockContainer:ne,dark:se,readOnly:me,languageSelect:he,copyButton:ce,windowsControl:ue,CodeMirrorContainer:ge,dragHandler:de,icon:pe,canDrag:ve,dragging:xe,drop:fe,before:be,after:ye},Ce={js:"javascript",ts:"typescript",rs:"rust",py:"python",md:"markdown",xml:"html/xml",latex:"stex"},we=v=>{const{onChange:m,children:x,element:i,onDidMount:h,onWillUnmount:c,attributes:s}=v,{code:u,language:g,uuid:L}=i,[H]=p.useState(u),[n,E]=p.useState(),r=F(),f=K(),{isDark:k}=W(),b=p.useRef(null),{drag:R,drop:A,isDragging:J,canDrag:X,canDrop:w,isBefore:T,isOverCurrent:M}=Y({element:i});p.useEffect(()=>{const e=Ce[g]||g,l=re.find(a=>a.name.toLowerCase()===e.toLowerCase());l&&E(l)},[g]);const q=(e,l,a)=>{const y=j.findPath(r,i);d.setNodes(r,{code:a},{at:y}),m&&m(a)},G=async()=>{const e=P.get(L);if(navigator.clipboard&&e){const l=e.getValue();await navigator.clipboard.writeText(l),await B.success("复制代码成功")}else await B.error("复制代码失败")},V=e=>{d.setNodes(r,{language:e},{at:j.findPath(r,i)})};return o.jsxs("div",{contentEditable:!1,className:_(t.codeBlockContainer,{[t.dark]:k,[t.readOnly]:f,[t.dragging]:J,[t.drop]:M&&w,[t.before]:T,[t.after]:!T}),ref:A,children:[o.jsx("div",{...s,style:{position:"absolute",top:0,left:0,right:0,bottom:0,pointerEvents:"none"},children:x}),o.jsx("div",{className:t.windowsControl}),o.jsx("div",{style:{background:`url(${z}) no-repeat center center / 60% 60%`},className:t.copyButton,onClick:G}),!f&&o.jsx(ie,{className:t.languageSelect,value:g,onChange:V}),o.jsx($,{value:H||"",autoCursor:!0,autoScroll:!0,options:{inputStyle:"textarea",mode:(n==null?void 0:n.mime)||(n==null?void 0:n.mode)||"text/plain",theme:k?"blackboard":"one-light",lineNumbers:!0,firstLineNumber:1,scrollbarStyle:"null",viewportMargin:1/0,lineWrapping:!1,smartIndent:!0,extraKeys:{"Shift-Tab":"indentLess"},readOnly:f||w&&M,indentUnit:2,tabSize:2,cursorHeight:1,autoCloseBrackets:!0,tabindex:-1},className:t.CodeMirrorContainer,onChange:q,editorDidMount:e=>{h&&h(e)},editorWillUnmount:e=>{c&&c(e)},onKeyDown:(e,l)=>{if(O(["delete","backspace"],l)&&e.getValue()===""){l.preventDefault();const a=j.findPath(r,i);Z.withoutNormalizing(r,()=>{d.delete(r,{at:a}),d.insertNodes(r,{type:"paragraph",children:[{type:"formatted",text:""}]},{at:a,select:!0})}),P.delete(L)}if(O("enter",l)){const a=e.getCursor(),y=e.getLine(a.line),D=e.lineCount();if(a.line===D-1&&y===""&&(l.preventDefault(),D!==1)){const C=e.getDoc(),S=a.line-1,N=C.getLine(S).length,Q={line:S,ch:N},I={line:a.line,ch:a.ch};C.replaceRange("",Q,I),C.setCursor({line:S,ch:N}),b.current&&b.current.addParagraph()}}}}),o.jsx(ee,{element:i,ref:b}),o.jsx("div",{contentEditable:!1,ref:R,className:_(t.dragHandler,{[t.canDrag]:X}),children:o.jsx(te,{className:t.icon})})]})};export{we as default};
